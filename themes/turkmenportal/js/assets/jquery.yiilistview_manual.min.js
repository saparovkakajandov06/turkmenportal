!function(a){var b={};a.fn.yiiListView=function(b){return this.each(function(){var c=a.extend({},a.fn.yiiListView.defaults,b||{}),d=a(this),e=d.attr("id");void 0==c.updateSelector&&(c.updateSelector="#"+e+" ."+c.pagerClass.replace(/\s+/g,".")+" a, #"+e+" ."+c.sorterClass.replace(/\s+/g,".")+" a"),a.fn.yiiListView.settings[e]=c,c.ajaxUpdate.length>0&&(a(document).on("click.yiiListView",c.updateSelector,function(){if(c.enableHistory&&window.History.enabled){var b=a(this).attr("href").split("?"),d=a.deparam.querystring("?"+(b[1]||""));delete d[c.ajaxVar],window.History.pushState(null,document.title,decodeURIComponent(a.param.querystring(b[0],d)))}else a.fn.yiiListView.update(e,{url:a(this).attr("href")});return!1}),c.enableHistory&&window.History.enabled&&a(window).bind("statechange",function(){var b=window.History.getState();a.fn.yiiListView.update(e,{url:b.url})}))})},a.fn.yiiListView.defaults={ajaxUpdate:[],ajaxVar:"ajax",ajaxType:"GET",pagerClass:"pager",loadingClass:"loading",sorterClass:"sorter"},a.fn.yiiListView.settings={},a.fn.yiiListView.getKey=function(b,c){return a("#"+b+" > div.keys > span:eq("+c+")").text()},a.fn.yiiListView.getUrl=function(b){var c=a.fn.yiiListView.settings[b];return c.url||a("#"+b+" > div.keys").attr("title")},a.fn.yiiListView.update=function(c,d){var e,f=a.fn.yiiListView.settings[c];d&&void 0!==d.error&&(e=d.error,delete d.error),d=a.extend({type:f.ajaxType,url:a.fn.yiiListView.getUrl(c),success:function(b,d){a.each(f.ajaxUpdate,function(c,d){var e="#"+d;a(e).replaceWith(a(e,"<div>"+b+"</div>"))}),void 0!=f.afterAjaxUpdate&&f.afterAjaxUpdate(c,b)},complete:function(){a("#"+c).removeClass(f.loadingClass),b[c]=null},error:function(a,b,c){var d,g;if(0!==a.readyState&&0!==a.status&&(void 0===e||(d=e(a),void 0===d||d))){switch(b){case"timeout":g="The request timed out!";break;case"parsererror":g="Parser error!";break;case"error":g=a.status&&!/^\s*$/.test(a.status)?"Error "+a.status:"Error",a.responseText&&!/^\s*$/.test(a.responseText)&&(g=g+": "+a.responseText)}void 0!==f.ajaxUpdateError?f.ajaxUpdateError(a,b,c,g):g&&alert(g)}}},d||{}),void 0!=d.data&&"GET"==d.type&&(d.url=a.param.querystring(d.url,d.data),d.data={}),f.ajaxVar&&(d.url=a.param.querystring(d.url,f.ajaxVar+"="+c)),null!=b[c]&&b[c].abort(),a("#"+c).addClass(f.loadingClass),void 0!=f.beforeAjaxUpdate&&f.beforeAjaxUpdate(c),b[c]=a.ajax(d)}}(jQuery);